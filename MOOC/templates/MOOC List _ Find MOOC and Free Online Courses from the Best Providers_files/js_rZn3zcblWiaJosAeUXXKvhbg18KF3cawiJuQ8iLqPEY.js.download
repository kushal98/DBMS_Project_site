(function($){Drupal.behaviors.custom_search={attach:function(context){if(!Drupal.settings.custom_search.solr){$('form.search-form',context).submit(function(){var $this=$(this);var box=$this.find('input.custom-search-box');if(box.val()!=undefined&&box.val()==''){$this.find('input.custom-search-box').addClass('error');return false;}
if($this.find('#edit-keys').parents('div.element-invisible').attr('class')=='element-invisible'){$this.find('#edit-keys').val($this.find('#edit-or').val());$this.find('#edit-or').val('');}
return true;});}
$('form.search-form').attr('target',Drupal.settings.custom_search.form_target);$('form.search-form input.custom-search-box',context).bind('click focus',function(e){var $parentForm=$(this).parents('form');var popup=$parentForm.find('fieldset.custom_search-popup');if(popup.find('input,select').length&&!popup.hasClass('opened')){popup.fadeIn().addClass('opened');}
e.stopPropagation();});$(document).bind('click focus',function(){$('fieldset.custom_search-popup').hide().removeClass('opened');});$('.custom-search-selector input:checkbox',context).each(function(){var el=$(this);if(el.val()=='c-all'){el.change(function(){$(this).parents('.custom-search-selector').find('input:checkbox[value!=c-all]').attr('checked',false);});}
else{if(el.val().substr(0,2)=='c-'){el.change(function(){$('.custom-search-selector input:checkbox').each(function(){if($(this).val().substr(0,2)=='o-'){$(this).attr('checked',false);}});$(this).parents('.custom-search-selector').find('input:checkbox[value=c-all]').attr('checked',false);});}else{el.change(function(){$(this).parents('.custom-search-selector').find('input:checkbox[value!='+el.val()+']').attr('checked',false);});}}});var popup=$('fieldset.custom_search-popup:not(.custom_search-processed)',context).addClass("custom_search-processed");popup.click(function(e){e.stopPropagation();})
popup.append('<a class="custom_search-popup-close" href="#">'+Drupal.t('Close')+'</a>');$('a.custom_search-popup-close').click(function(e){$('fieldset.custom_search-popup.opened').hide().removeClass('opened');e.preventDefault();});}}})(jQuery);;(function($){Drupal.behaviors.autocomplete={attach:function(context,settings){var acdb=[];$('input.autocomplete',context).once('autocomplete',function(){var uri=this.value;if(!acdb[uri]){acdb[uri]=new Drupal.ACDB(uri);}
var $input=$('#'+this.id.substr(0,this.id.length-13)).attr('autocomplete','OFF').attr('aria-autocomplete','list');$($input[0].form).submit(Drupal.autocompleteSubmit);$input.parent().attr('role','application').append($('<span class="element-invisible" aria-live="assertive"></span>').attr('id',$input.attr('id')+'-autocomplete-aria-live'));new Drupal.jsAC($input,acdb[uri]);});}};Drupal.autocompleteSubmit=function(){return $('#autocomplete').each(function(){this.owner.hidePopup();}).length==0;};Drupal.jsAC=function($input,db){var ac=this;this.input=$input[0];this.ariaLive=$('#'+this.input.id+'-autocomplete-aria-live');this.db=db;$input.keydown(function(event){return ac.onkeydown(this,event);}).keyup(function(event){ac.onkeyup(this,event);}).blur(function(){ac.hidePopup();ac.db.cancel();});};Drupal.jsAC.prototype.onkeydown=function(input,e){if(!e){e=window.event;}
switch(e.keyCode){case 40:this.selectDown();return false;case 38:this.selectUp();return false;default:return true;}};Drupal.jsAC.prototype.onkeyup=function(input,e){if(!e){e=window.event;}
switch(e.keyCode){case 16:case 17:case 18:case 20:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:return true;case 9:case 13:case 27:this.hidePopup(e.keyCode);return true;default:if(input.value.length>0&&!input.readOnly){this.populatePopup();}
else{this.hidePopup(e.keyCode);}
return true;}};Drupal.jsAC.prototype.select=function(node){this.input.value=$(node).data('autocompleteValue');$(this.input).trigger('autocompleteSelect',[node]);};Drupal.jsAC.prototype.selectDown=function(){if(this.selected&&this.selected.nextSibling){this.highlight(this.selected.nextSibling);}
else if(this.popup){var lis=$('li',this.popup);if(lis.length>0){this.highlight(lis.get(0));}}};Drupal.jsAC.prototype.selectUp=function(){if(this.selected&&this.selected.previousSibling){this.highlight(this.selected.previousSibling);}};Drupal.jsAC.prototype.highlight=function(node){if(this.selected){$(this.selected).removeClass('selected');}
$(node).addClass('selected');this.selected=node;$(this.ariaLive).html($(this.selected).html());};Drupal.jsAC.prototype.unhighlight=function(node){$(node).removeClass('selected');this.selected=false;$(this.ariaLive).empty();};Drupal.jsAC.prototype.hidePopup=function(keycode){if(this.selected&&((keycode&&keycode!=46&&keycode!=8&&keycode!=27)||!keycode)){this.select(this.selected);}
var popup=this.popup;if(popup){this.popup=null;$(popup).fadeOut('fast',function(){$(popup).remove();});}
this.selected=false;$(this.ariaLive).empty();};Drupal.jsAC.prototype.populatePopup=function(){var $input=$(this.input);var position=$input.position();if(this.popup){$(this.popup).remove();}
this.selected=false;this.popup=$('<div id="autocomplete"></div>')[0];this.popup.owner=this;$(this.popup).css({top:parseInt(position.top+this.input.offsetHeight,10)+'px',left:parseInt(position.left,10)+'px',width:$input.innerWidth()+'px',display:'none'});$input.before(this.popup);this.db.owner=this;this.db.search(this.input.value);};Drupal.jsAC.prototype.found=function(matches){if(!this.input.value.length){return false;}
var ul=$('<ul></ul>');var ac=this;for(key in matches){$('<li></li>').html($('<div></div>').html(matches[key])).mousedown(function(){ac.hidePopup(this);}).mouseover(function(){ac.highlight(this);}).mouseout(function(){ac.unhighlight(this);}).data('autocompleteValue',key).appendTo(ul);}
if(this.popup){if(ul.children().length){$(this.popup).empty().append(ul).show();$(this.ariaLive).html(Drupal.t('Autocomplete popup'));}
else{$(this.popup).css({visibility:'hidden'});this.hidePopup();}}};Drupal.jsAC.prototype.setStatus=function(status){switch(status){case 'begin':$(this.input).addClass('throbbing');$(this.ariaLive).html(Drupal.t('Searching for matches...'));break;case 'cancel':case 'error':case 'found':$(this.input).removeClass('throbbing');break;}};Drupal.ACDB=function(uri){this.uri=uri;this.delay=300;this.cache={};};Drupal.ACDB.prototype.search=function(searchString){var db=this;this.searchString=searchString;searchString=searchString.replace(/^\s+|\.{2,}\/|\s+$/g,'');if(searchString.length<=0||searchString.charAt(searchString.length-1)==','){return;}
if(this.cache[searchString]){return this.owner.found(this.cache[searchString]);}
if(this.timer){clearTimeout(this.timer);}
this.timer=setTimeout(function(){db.owner.setStatus('begin');$.ajax({type:'GET',url:db.uri+'/'+Drupal.encodePath(searchString),dataType:'json',success:function(matches){if(typeof matches.status=='undefined'||matches.status!=0){db.cache[searchString]=matches;if(db.searchString==searchString){db.owner.found(matches);}
db.owner.setStatus('found');}},error:function(xmlhttp){Drupal.displayAjaxError(Drupal.ajaxError(xmlhttp,db.uri));}});},this.delay);};Drupal.ACDB.prototype.cancel=function(){if(this.owner)this.owner.setStatus('cancel');if(this.timer)clearTimeout(this.timer);this.searchString='';};})(jQuery);;(function($){Drupal.progressBar=function(id,updateCallback,method,errorCallback){var pb=this;this.id=id;this.method=method||'GET';this.updateCallback=updateCallback;this.errorCallback=errorCallback;this.element=$('<div class="progress" aria-live="polite"></div>').attr('id',id);this.element.html('<div class="bar"><div class="filled"></div></div>'+
'<div class="percentage"></div>'+
'<div class="message">&nbsp;</div>');};Drupal.progressBar.prototype.setProgress=function(percentage,message){if(percentage>=0&&percentage<=100){$('div.filled',this.element).css('width',percentage+'%');$('div.percentage',this.element).html(percentage+'%');}
$('div.message',this.element).html(message);if(this.updateCallback){this.updateCallback(percentage,message,this);}};Drupal.progressBar.prototype.startMonitoring=function(uri,delay){this.delay=delay;this.uri=uri;this.sendPing();};Drupal.progressBar.prototype.stopMonitoring=function(){clearTimeout(this.timer);this.uri=null;};Drupal.progressBar.prototype.sendPing=function(){if(this.timer){clearTimeout(this.timer);}
if(this.uri){var pb=this;$.ajax({type:this.method,url:this.uri,data:'',dataType:'json',success:function(progress){if(progress.status==0){pb.displayError(progress.data);return;}
pb.setProgress(progress.percentage,progress.message);pb.timer=setTimeout(function(){pb.sendPing();},pb.delay);},error:function(xmlhttp){pb.displayError(Drupal.ajaxError(xmlhttp,pb.uri));}});}};Drupal.progressBar.prototype.displayError=function(string){var error=$('<div class="messages error"></div>').html(string);$(this.element).before(error).hide();if(this.errorCallback){this.errorCallback(this);}};})(jQuery);;(function($){Drupal.Views={};Drupal.behaviors.viewsTabs={attach:function(context){if($.viewsUi&&$.viewsUi.tabs){$('#views-tabset').once('views-processed').viewsTabs({selectedClass:'active'});}
$('a.views-remove-link').once('views-processed').click(function(event){var id=$(this).attr('id').replace('views-remove-link-','');$('#views-row-'+id).hide();$('#views-removed-'+id).attr('checked',true);event.preventDefault();});$('a.display-remove-link').addClass('display-processed').click(function(){var id=$(this).attr('id').replace('display-remove-link-','');$('#display-row-'+id).hide();$('#display-removed-'+id).attr('checked',true);return false;});}};Drupal.Views.parseQueryString=function(query){var args={};var pos=query.indexOf('?');if(pos!=-1){query=query.substring(pos+1);}
var pairs=query.split('&');for(var i in pairs){if(typeof(pairs[i])=='string'){var pair=pairs[i].split('=');if(pair[0]!='q'&&pair[1]){args[decodeURIComponent(pair[0].replace(/\+/g,' '))]=decodeURIComponent(pair[1].replace(/\+/g,' '));}}}
return args;};Drupal.Views.parseViewArgs=function(href,viewPath){if(Drupal.settings.pathPrefix){var viewPath=Drupal.settings.pathPrefix+viewPath;}
var returnObj={};var path=Drupal.Views.getPath(href);if(viewPath&&path.substring(0,viewPath.length+1)==viewPath+'/'){var args=decodeURIComponent(path.substring(viewPath.length+1,path.length));returnObj.view_args=args;returnObj.view_path=path;}
return returnObj;};Drupal.Views.pathPortion=function(href){var protocol=window.location.protocol;if(href.substring(0,protocol.length)==protocol){href=href.substring(href.indexOf('/',protocol.length+2));}
return href;};Drupal.Views.getPath=function(href){href=Drupal.Views.pathPortion(href);href=href.substring(Drupal.settings.basePath.length,href.length);if(href.substring(0,3)=='?q='){href=href.substring(3,href.length);}
var chars=['#','?','&'];for(var i in chars){if(href.indexOf(chars[i])>-1){href=href.substr(0,href.indexOf(chars[i]));}}
return href;};})(jQuery);;(function($){Drupal.behaviors.ViewsAjaxView={};Drupal.behaviors.ViewsAjaxView.attach=function(){if(Drupal.settings&&Drupal.settings.views&&Drupal.settings.views.ajaxViews){$.each(Drupal.settings.views.ajaxViews,function(i,settings){Drupal.views.instances[i]=new Drupal.views.ajaxView(settings);});}};Drupal.views={};Drupal.views.instances={};Drupal.views.ajaxView=function(settings){var selector='.view-dom-id-'+settings.view_dom_id;this.$view=$(selector);var ajax_path=Drupal.settings.views.ajax_path;if(ajax_path.constructor.toString().indexOf("Array")!=-1){ajax_path=ajax_path[0];}
var queryString=window.location.search||'';if(queryString!==''){var queryString=queryString.slice(1).replace(/q=[^&]+&?|&?render=[^&]+/,'');if(queryString!==''){queryString=((/\?/.test(ajax_path))?'&':'?')+queryString;}}
this.element_settings={url:ajax_path+queryString,submit:settings,setClick:true,event:'click',selector:selector,progress:{type:'throbber'}};this.settings=settings;this.$exposed_form=$('#views-exposed-form-'+settings.view_name.replace(/_/g,'-')+'-'+settings.view_display_id.replace(/_/g,'-'));this.$exposed_form.once(jQuery.proxy(this.attachExposedFormAjax,this));this.links=[];this.$view.filter(jQuery.proxy(this.filterNestedViews,this)).once(jQuery.proxy(this.attachPagerAjax,this));var self_settings=this.element_settings;self_settings.event='RefreshView';this.refreshViewAjax=new Drupal.ajax(this.selector,this.$view,self_settings);};Drupal.views.ajaxView.prototype.attachExposedFormAjax=function(){var button=$('input[type=submit], button[type=submit], input[type=image]',this.$exposed_form);button=button[0];this.exposedFormAjax=new Drupal.ajax($(button).attr('id'),button,this.element_settings);};Drupal.views.ajaxView.prototype.filterNestedViews=function(){return!this.$view.parents('.view').size();};Drupal.views.ajaxView.prototype.attachPagerAjax=function(){this.$view.find('ul.pager > li > a, th.views-field a, .attachment .views-summary a').each(jQuery.proxy(this.attachPagerLinkAjax,this));};Drupal.views.ajaxView.prototype.attachPagerLinkAjax=function(id,link){var $link=$(link);var viewData={};var href=$link.attr('href');$.extend(viewData,this.settings,Drupal.Views.parseQueryString(href),Drupal.Views.parseViewArgs(href,this.settings.view_base_path));$.extend(viewData,Drupal.Views.parseViewArgs(href,this.settings.view_base_path));this.element_settings.submit=viewData;this.pagerAjax=new Drupal.ajax(false,$link,this.element_settings);this.links.push(this.pagerAjax);};Drupal.ajax.prototype.commands.viewsScrollTop=function(ajax,response,status){var offset=$(response.selector).offset();var scrollTarget=response.selector;while($(scrollTarget).scrollTop()==0&&$(scrollTarget).parent()){scrollTarget=$(scrollTarget).parent();}
if(offset.top-10<$(scrollTarget).scrollTop()){$(scrollTarget).animate({scrollTop:(offset.top-10)},500);}};})(jQuery);;(function($){Drupal.behaviors.fivestar={attach:function(context){$(context).find('div.fivestar-form-item').once('fivestar',function(){var $this=$(this);var $container=$('<div class="fivestar-widget clearfix"></div>');var $select=$('select',$this);var $cancel=$('option[value="0"]',$this);if($cancel.length){$('<div class="cancel"><a href="#0" title="'+$cancel.text()+'">'+$cancel.text()+'</a></div>').appendTo($container);}
var $options=$('option',$this).not('[value="-"], [value="0"]');var index=-1;$options.each(function(i,element){var classes='star-'+(i+1);classes+=(i+1)%2==0?' even':' odd';classes+=i==0?' star-first':'';classes+=i+1==$options.length?' star-last':'';$('<div class="star"><a href="#'+element.value+'" title="'+element.text+'">'+element.text+'</a></div>').addClass(classes).appendTo($container);if(element.value==$select.val()){index=i+1;}});if(index!=-1){$container.find('.star').slice(0,index).addClass('on');}
$container.addClass('fivestar-widget-'+($options.length));$container.find('a').bind('click',$this,Drupal.behaviors.fivestar.rate).bind('mouseover',$this,Drupal.behaviors.fivestar.hover);$container.bind('mouseover mouseout',$this,Drupal.behaviors.fivestar.hover);$select.after($container).css('display','none');Drupal.attachBehaviors($this);});},rate:function(event){var $this=$(this);var $widget=event.data;var value=this.hash.replace('#','');$('select',$widget).val(value).change();var $this_star=(value==0)?$this.parent().parent().find('.star'):$this.closest('.star');$this_star.prevAll('.star').andSelf().addClass('on');$this_star.nextAll('.star').removeClass('on');if(value==0){$this_star.removeClass('on');}
event.preventDefault();},hover:function(event){var $this=$(this);var $widget=event.data;var $target=$(event.target);var $stars=$('.star',$this);if(event.type=='mouseover'){var index=$stars.index($target.parent());$stars.each(function(i,element){if(i<=index){$(element).addClass('hover');}else{$(element).removeClass('hover');}});}else{$stars.removeClass('hover');}}};})(jQuery);;(function($){Drupal.ajax.prototype.commands.fivestarUpdate=function(ajax,response,status){response.selector=$('.fivestar-form-item',ajax.element.form);ajax.commands.insert(ajax,response,status);};})(jQuery);;(function($){Drupal.behaviors.chosen={attach:function(context,settings){settings.chosen=settings.chosen||Drupal.settings.chosen;var selector=settings.chosen.selector;var getElementOptions=function(element){var options=$.extend({},settings.chosen.options);if(settings.chosen.minimum_width>0){if($(element).width()<settings.chosen.minimum_width){options.width=settings.chosen.minimum_width+'px';}
else{options.width=$(element).width()+'px';}}
if($(element).attr('multiple')&&$(element).data('cardinality')){options.max_selected_options=$(element).data('cardinality');}
return options;};$('select.chosen-enable, select.chosen-widget',context).once('chosen',function(){options=getElementOptions(this);$(this).chosen(options);});$(selector,context).not('#field-ui-field-overview-form select, #field-ui-display-overview-form select, .wysiwyg, .draggable select[name$="[weight]"], .draggable select[name$="[position]"], .chosen-disable, .chosen-processed').filter(function(){var minOptions=$(this).attr('multiple')?settings.chosen.minimum_multiple:settings.chosen.minimum_single;if(!minOptions){return true;}
else{return $(this).find('option').length>=minOptions;}}).once('chosen',function(){options=getElementOptions(this);$(this).chosen(options);});}};})(jQuery);;